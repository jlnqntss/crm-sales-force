<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>60.0</apiVersion>
    <assignments>
        <name>A_adir_Contacto</name>
        <label>Añadir Contacto</label>
        <locationX>534</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>contactsIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Asistentes.RelationId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Asistentes</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>A_adir_Contactos</name>
        <label>Añadir Contactos</label>
        <locationX>138</locationX>
        <locationY>2363</locationY>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Contactos.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>saltoDeLinea</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contactos</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>A_adir_Lead</name>
        <label>Añadir Lead</label>
        <locationX>798</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>leadsIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Asistentes.RelationId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Asistentes</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>A_adir_Leads</name>
        <label>Añadir Leads</label>
        <locationX>138</locationX>
        <locationY>2963</locationY>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Leads.Name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Leads</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>A_adir_owner_como_asistente</name>
        <label>Añadir owner como asistente</label>
        <locationX>356</locationX>
        <locationY>431</locationY>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Obtener_Owner.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>saltoDeLinea</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Obtener_asistentes</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>A_adir_Usuario</name>
        <label>Añadir Usuario</label>
        <locationX>270</locationX>
        <locationY>971</locationY>
        <assignmentItems>
            <assignToReference>usersIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Asistentes.RelationId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Asistentes</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>A_adir_Usuarios</name>
        <label>Añadir Usuarios</label>
        <locationX>138</locationX>
        <locationY>1763</locationY>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Usuarios.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>asistentesText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>saltoDeLinea</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Usuarios</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Modalidad_online</name>
        <label>Modalidad online</label>
        <locationX>422</locationX>
        <locationY>3647</locationY>
        <assignmentItems>
            <assignToReference>$Record.Modalidad__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Online</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Asignar_Acta</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Modalidad_presencial</name>
        <label>Modalidad presencial</label>
        <locationX>686</locationX>
        <locationY>3647</locationY>
        <assignmentItems>
            <assignToReference>$Record.Modalidad__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Presencial</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Asignar_Acta</targetReference>
        </connector>
    </assignments>
    <constants>
        <name>contactPrefix</name>
        <dataType>String</dataType>
        <value>
            <stringValue>003</stringValue>
        </value>
    </constants>
    <constants>
        <name>emptyString</name>
        <dataType>String</dataType>
        <value>
            <stringValue></stringValue>
        </value>
    </constants>
    <constants>
        <name>userPrefix</name>
        <dataType>String</dataType>
        <value>
            <stringValue>005</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Es_Contact</name>
        <label>Es Contact</label>
        <locationX>666</locationX>
        <locationY>971</locationY>
        <defaultConnector>
            <targetReference>A_adir_Lead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Asistentes.RelationId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <elementReference>contactPrefix</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>A_adir_Contacto</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Es_online</name>
        <label>Es online?</label>
        <locationX>554</locationX>
        <locationY>3539</locationY>
        <defaultConnector>
            <targetReference>Modalidad_presencial</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S8</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Description</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Microsoft Teams</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Modalidad_online</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Es_Usuario</name>
        <label>Es Usuario</label>
        <locationX>468</locationX>
        <locationY>863</locationY>
        <defaultConnector>
            <targetReference>Es_Contact</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Asistentes.RelationId</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <elementReference>userPrefix</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>A_adir_Usuario</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Existe_acta</name>
        <label>Existe acta?</label>
        <locationX>356</locationX>
        <locationY>3323</locationY>
        <defaultConnector>
            <targetReference>Crear_Acta</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S7</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Acta__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Actualizar_acta</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Hay_asistentes</name>
        <label>Hay asistentes?</label>
        <locationX>356</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Existe_acta</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Obtener_asistentes</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Asistentes</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Hay_Contactos</name>
        <label>Hay Contactos?</label>
        <locationX>182</locationX>
        <locationY>2039</locationY>
        <defaultConnector>
            <targetReference>Hay_Leads</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S5</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>contactsIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Obtener_Contactos</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Hay_Leads</name>
        <label>Hay Leads?</label>
        <locationX>182</locationX>
        <locationY>2639</locationY>
        <defaultConnector>
            <targetReference>Existe_acta</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S6</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>leadsIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Obtener_Leads</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <decisions>
        <name>Hay_Usuarios</name>
        <label>Hay Usuarios?</label>
        <locationX>182</locationX>
        <locationY>1439</locationY>
        <defaultConnector>
            <targetReference>Hay_Contactos</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>S4</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>usersIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Obtener_Usuarios</targetReference>
            </connector>
            <label>Sí</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <interviewLabel>Event Trigger - After insert/update Crear Acta {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Event Trigger - After insert/update Crear Acta</label>
    <loops>
        <name>Asistentes</name>
        <label>Asistentes</label>
        <locationX>182</locationX>
        <locationY>755</locationY>
        <collectionReference>Obtener_asistentes</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Es_Usuario</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Hay_Usuarios</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Contactos</name>
        <label>Contactos</label>
        <locationX>50</locationX>
        <locationY>2255</locationY>
        <collectionReference>Obtener_Contactos</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>A_adir_Contactos</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Hay_Leads</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Leads</name>
        <label>Leads</label>
        <locationX>50</locationX>
        <locationY>2855</locationY>
        <collectionReference>Obtener_Leads</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>A_adir_Leads</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Existe_acta</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Usuarios</name>
        <label>Usuarios</label>
        <locationX>50</locationX>
        <locationY>1655</locationY>
        <collectionReference>Obtener_Usuarios</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>A_adir_Usuarios</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Hay_Contactos</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Crear_Acta</name>
        <label>Crear Acta</label>
        <locationX>554</locationX>
        <locationY>3431</locationY>
        <connector>
            <targetReference>Es_online</targetReference>
        </connector>
        <inputAssignments>
            <field>Attendees__c</field>
            <value>
                <elementReference>asistentesText</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Location__c</field>
            <value>
                <elementReference>$Record.Location</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MeetingObjective__c</field>
            <value>
                <elementReference>$Record.Subject</elementReference>
            </value>
        </inputAssignments>
        <object>Acta__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Obtener_asistentes</name>
        <label>Obtener asistentes</label>
        <locationX>356</locationX>
        <locationY>539</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Hay_asistentes</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>EventId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>EventRelation</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obtener_Contactos</name>
        <label>Obtener Contactos</label>
        <locationX>50</locationX>
        <locationY>2147</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Contactos</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>contactsIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obtener_Leads</name>
        <label>Obtener Leads</label>
        <locationX>50</locationX>
        <locationY>2747</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Leads</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>leadsIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Lead</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obtener_Owner</name>
        <label>Obtener Owner</label>
        <locationX>356</locationX>
        <locationY>323</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>A_adir_owner_como_asistente</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obtener_Usuarios</name>
        <label>Obtener Usuarios</label>
        <locationX>50</locationX>
        <locationY>1547</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Usuarios</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>usersIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Actualizar_acta</name>
        <label>Actualizar acta</label>
        <locationX>158</locationX>
        <locationY>3431</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Acta__r.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Attendees__c</field>
            <value>
                <elementReference>asistentesText</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Location__c</field>
            <value>
                <elementReference>$Record.Location</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MeetingObjective__c</field>
            <value>
                <elementReference>$Record.Subject</elementReference>
            </value>
        </inputAssignments>
        <object>Acta__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Asignar_Acta</name>
        <label>Asignar Acta</label>
        <locationX>554</locationX>
        <locationY>3839</locationY>
        <inputAssignments>
            <field>Acta__c</field>
            <value>
                <elementReference>Crear_Acta</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>230</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Obtener_Owner</targetReference>
        </connector>
        <filterFormula>AND(ISPICKVAL({!$Record.RelatedToIntermediary__c}, &apos;Yes&apos;), OR({!$UserRole.DeveloperName} = &apos;SDMHomeOffice&apos;, {!$UserRole.DeveloperName} = &apos;SDM_Consultor&apos;, {!$UserRole.DeveloperName} = &apos;SDM_CV&apos;, {!$UserRole.DeveloperName} = &apos;SDM_DT&apos;, {!$UserRole.DeveloperName} = &apos;SDM_DV&apos;, {!$UserRole.DeveloperName} = &apos;SDM_RN&apos;))</filterFormula>
        <object>Event</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>saltoDeLinea</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>{!emptyString}
{!emptyString}</text>
    </textTemplates>
    <variables>
        <name>asistentesText</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>contactsIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>leadsIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>usersIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
