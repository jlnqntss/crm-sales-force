<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>CCSVariablesAssignment</name>
        <label>Assign CCS Variables</label>
        <locationX>314</locationX>
        <locationY>278</locationY>
        <assignmentItems>
            <assignToReference>relatedId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailRecord.RelatedToId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>subflowDevName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CCSSubflow</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>URLAssignment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>CSMVariablesAssignment</name>
        <label>Assign CSM Variables</label>
        <locationX>578</locationX>
        <locationY>278</locationY>
        <assignmentItems>
            <assignToReference>relatedId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailRecord.RelatedToId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>subflowDevName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CSMSubflow</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>URLAssignment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>RecordIdAssignment</name>
        <label>AssignRecordId</label>
        <locationX>1106</locationX>
        <locationY>278</locationY>
        <assignmentItems>
            <assignToReference>screenPopURL</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailRecord.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>URLAssignment</name>
        <label>Assign URL</label>
        <locationX>578</locationX>
        <locationY>614</locationY>
        <assignmentItems>
            <assignToReference>screenPopURL</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>urlFormula</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>USPVariablesAssignment</name>
        <label>Assign USP Variables</label>
        <locationX>842</locationX>
        <locationY>278</locationY>
        <assignmentItems>
            <assignToReference>relatedId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailRecord.RelatedToId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>subflowDevName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>USPSubflow</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>URLAssignment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>ZEVariablesAssignment</name>
        <label>Assign ZE Variables</label>
        <locationX>50</locationX>
        <locationY>278</locationY>
        <assignmentItems>
            <assignToReference>relatedId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailRecord.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>subflowDevName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ZESubflow</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>URLAssignment</targetReference>
        </connector>
    </assignments>
    <constants>
        <name>CCSSubflow</name>
        <dataType>String</dataType>
        <value>
            <stringValue>CCSSearchAndScreenPop</stringValue>
        </value>
    </constants>
    <constants>
        <name>CSMSubflow</name>
        <dataType>String</dataType>
        <value>
            <stringValue>CSMSearchAndScreenPop</stringValue>
        </value>
    </constants>
    <constants>
        <name>USPSubflow</name>
        <dataType>String</dataType>
        <value>
            <stringValue>USPSearchAndScreenPop</stringValue>
        </value>
    </constants>
    <constants>
        <name>ZESubflow</name>
        <dataType>String</dataType>
        <value>
            <stringValue>ZESearchAndScreenPop</stringValue>
        </value>
    </constants>
    <decisions>
        <name>ScopeDecision</name>
        <label>Scope</label>
        <locationX>578</locationX>
        <locationY>158</locationY>
        <defaultConnector>
            <targetReference>RecordIdAssignment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ZEOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>scopeValue</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>ZE</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>ZEVariablesAssignment</targetReference>
            </connector>
            <label>ZE</label>
        </rules>
        <rules>
            <name>CCSOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>emailRecord.GenesysQueueName__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>CCS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>scopeValue</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>ZE</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CCSVariablesAssignment</targetReference>
            </connector>
            <label>CCS</label>
        </rules>
        <rules>
            <name>CSMOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>emailRecord.GenesysQueueName__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>CSM</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>scopeValue</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>ZE</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CSMVariablesAssignment</targetReference>
            </connector>
            <label>CSM</label>
        </rules>
        <rules>
            <name>USPOutcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>emailRecord.GenesysQueueName__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>USP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>scopeValue</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>ZE</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>USPVariablesAssignment</targetReference>
            </connector>
            <label>USP</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>urlFormula</name>
        <dataType>String</dataType>
        <expression>&apos;/lightning/page/recordActionFlow?lightning__flowDevName=&apos;+{!subflowDevName}+&apos;&amp;lightning__flowArgs=[{&quot;name&quot;: &quot;phone&quot;, &quot;type&quot;: &quot;String&quot;,&quot;value&quot;: &quot;&apos; + {!emailRecord.FromAddress} + &apos;&quot;},{&quot;name&quot;: &quot;relatedrecordid&quot;, &quot;type&quot;: &quot;String&quot;,&quot;value&quot;: &quot;&apos; + {!relatedId}+ &apos;&quot;}, {&quot;name&quot;: &quot;recordid&quot;, &quot;type&quot;: &quot;String&quot;,&quot;value&quot;: &quot;&apos; + {!relatedToAccountId}+ &apos;&quot;}]&apos;</expression>
    </formulas>
    <interviewLabel>Generate Screen Pop URL {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Generate Screen Pop URL</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <runInMode>DefaultMode</runInMode>
    <start>
        <locationX>452</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>ScopeDecision</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>emailRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>EmailMessage</objectType>
    </variables>
    <variables>
        <name>relatedId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>relatedToAccountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>scopeValue</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>screenPopURL</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>subflowDevName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
